<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0>
		<style>
			body {
				padding: 0;
				margin: 0;
			}
		</style>
		<script>

			//Static
			var cnv;
			var w = window.innerWidth;       //width
			var h = window.innerHeight * 0.9; //height
			var r = 50;                    //radius
			var g = 0.25;                 //acc by G
			var k = 2;                   //spring constant
			var t = 1;                  //throw power
			//Dynamic
			var x = r + w / 2 - r;
			var y = r + h / 2 - r;
			var vy = 0;
			var vx = 2;
			var ax = 0;
			var ay = 0;
			var ex = 0;
			var ey = 0;


			function setup() {
				cnv = createCanvas(w, h);
			}

			function draw() {
				background(255);

				//Border
				noFill();
				stroke(0);
				rect(1, 1, w - 2, h - 2);
				fill(0);

				//StartLine
				//~pKoded
				//line(w/2 - rx, h/2-ry, w/2 +rx, h/2-ry);

				//Bounce
				if (y >= h - r && vy > 0) {
					vy *= -1;
					y = h - r;
				}
				if (x >= w - r && vx >= 0) {
					vx *= -1;
					x = w - r;
				}
				if (x <= r && vx < 0) {
					vx *= -1;
					x = r;
				}

				ex = 0; ey = 0;
				//Hold
				if (mouseIsPressed && onCanvas()) {
					if (onBall()) Hold();
					else {
						pull();
					}
				} else waspulln = false;

				//Draw
				ellipse(x, y, 2 * r, 2 * r);

				//Forces
				ay = g + ey;
				ax = 0 + ex;

				//Acceleration
				vx += ax;
				vy += ay;

				//Movement
				x += vx;
				y += vy;
			}
			var dx = 0, dy = 0;
			function mousePressed() {
				if (onBall()) {
					dx = x - mouseX;
					dy = y - mouseY;
				}
			}

			function Hold() {
				if (waspulln) {
					dx = x - mouseX;
					dy = y - mouseY;
					waspulln = false;
				}
				//setPosition
				if (mouseX + dx >= (w - r)) x = w - r;
				else x = mouseX + dx;
				if (mouseX + dx <= r) x = r;
				else x = mouseX + dx;
				if (mouseY + dy >= (h - r)) y = h - r;
				else y = mouseY + dy;
				if (mouseY + dy <= r) y = r;
				else y = mouseY + dy;

				//Throw
				vx = (mouseX - pmouseX) / 3 * t; vy = (mouseY - pmouseY) / 3 * t;

			}

			function onCanvas() {
				if (mouseX >= w || mouseX <= 0) return false;
				else if (mouseY >= h || mouseY <= 0) return false;
				return true;
			}

			function onBall() {
				if (dist(x, y, mouseX, mouseY) < r) return true;
				return false;
			}
			var waspulln = false;
			function pull() {
				strokeWeight(dist(mouseX, mouseY, x, y) / 100); stroke(100, 100, 200);
				line(mouseX, mouseY, x, y);
				strokeWeight(1); stroke(0);
				ex = (mouseX - x) / 1000 * k;
				ey = (mouseY - y) / 1000 * k;
				waspulln = true;
			}


		</script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.1/p5.js"></script>
	</head>

	<body>
	</body>

</html>